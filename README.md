# «Может кофейку?»

Консольное приложение на C# для анализа CSV-данных с отзывами Starbucks


## Общая информация

Программа реализует справочную систему для обработки и анализа отзывов посетителей кофейни Starbucks, представленных в формате CSV.
Работа с данными осуществляется через экранное меню и диалог с пользователем.


## Исходные данные

* Формат входных данных: CSV
* Первичный файл: `reviews_data.csv`
* Первая строка файла — заголовки столбцов
* Структура CSV-файла строго фиксирована:

```
name,location,Date,Rating,Review,Image_Links
```

* В CSV могут встречаться:

  * пустые поля;
  * пропуски значений;
  * строки в кавычках с запятыми внутри.
* Номера строк не загружаются в объекты, но сохраняются при записи файлов.


## Функциональные возможности

После запуска программы пользователю доступно текстовое меню:

1. **Ввести / сменить путь к CSV-файлу**
2. **Загрузить данные из файла**
3. **Вывести отзывы с максимальным рейтингом за 2020 и 2021 годы**
4. **Сохранить в файл отзывы с выбранным рейтингом**
5. **Вывести сводную статистику**
6. **Завершить работу программы**

## Выходные файлы

В ходе работы программа может создавать следующие CSV-файлы:

* `top-reviews-20-21.csv`
  Содержит отзывы с рейтингом, введённым пользователем (от 1 до 5)

Файлы:

* создаются автоматически;
* имеют корректную кодировку;
* полностью совместимы со структурой исходного CSV.

---

## Архитектура проекта

Проект реализован с соблюдением принципов ООП и SRP (Single Responsibility Principle).

Каждый класс вынесен в отдельный файл.

### Структура проекта

```
Project_2
│
├── Program.cs        
├── Methods.cs        
├── Review.cs        
├── Statistics.cs    
```


## Описание классов

### Program

**Назначение:**

* управление программным циклом;
* отображение меню;
* обработка пользовательского ввода;
* вызов методов бизнес-логики.

**Ключевые особенности:**

* программа работает до нажатия `Escape`;
* реализована проверка корректности выбора пунктов меню;
* без загрузки данных доступ к аналитическим пунктам запрещён.

---

### Review

**Назначение:**
Модель одного отзыва.

**Поля и свойства:**

* `Name` — имя автора отзыва
* `Location` — место
* `Date` — дата (массив строк: месяц и год)
* `Rating` — рейтинг (`1–5` или `N/A`)
* `_Review` — текст отзыва
* `Image_Links` — массив ссылок на изображения

**Особенности:**

* данные о ссылках на изображения не используются в аналитике, но корректно загружаются;
* CSV-строка корректно парсится даже при наличии кавычек и запятых.

---

### Methods (static)

**Назначение:**
Реализация пунктов меню 2–4.

**Основные методы:**

* `ReadFile()`
  Чтение CSV-файла с обработкой ошибок
* `GetReview()`
  Корректный парсинг CSV-строки без использования библиотек
* `CreateReviews()`
  Создание массива объектов `Review`
* `ReviewHighestRating()`
  Поиск максимального рейтинга за 2020 и 2021 годы
* `ReviewsWithRatingN()`
  Формирование выборки по рейтингу и сохранение в файл
* `WritingToFile()`
  Запись CSV-файла

### Statistics

**Назначение:**
Реализация пункта меню 5 — сводная статистика.

**Реализованы:**

#### Количество отзывов по годам

#### Процентное соотношение рейтингов

#### Соотношение отзывов с рейтингом 1:

* с изображениями
* без изображений

#### Количество отзывов:

* с рейтингом 1–2
* с рейтингом 3–4
  по каждому году

## Используемые технологии

* Язык: C#
* Платформа: .NET
* Работа с файлами:

  * `System.IO`
  * `StringBuilder`


## Обработка ошибок

Программа устойчива к следующим ситуациям:

* неверный путь к файлу;
* отсутствие файла;
* некорректная структура CSV;
* неверный ввод пунктов меню;
* некорректный рейтинг (не в диапазоне 1–5).

При ошибках:

* выводится сообщение пользователю;
* программа не завершается аварийно;
* управление возвращается в меню.

### Реализация дополнительного задания

В проекте `Project_2_dop` реализована обработка загруженных CSV-данных с возможностью их дополнительной аналитической переработки и сохранения результатов в отдельный файл.

#### Ввод имени выходного файла пользователем

В ходе работы программы пользователь:

* вводит имя выходного CSV-файла с клавиатуры;
* имя файла используется без жёсткого задания в коде, что позволяет сохранять результат под произвольным названием.

При вводе некорректных данных:

* выходной файл не создаётся;
* пользователю выводится сообщение об ошибке;
* выполнение программы продолжается без аварийного завершения.

### Группировка отзывов по рейтингу

Дополнительный проект реализует группировку данных об отзывах по значению рейтинга (`Rating`).

В рамках данной операции:

* исходный набор отзывов последовательно обрабатывается;
* формируются группы отзывов с одинаковыми значениями рейтинга;
* для каждой группы производится подсчёт количества отзывов.

Результаты группировки:

* сохраняются в CSV-файл с именем, заданным пользователем;
* имеют корректную структуру, совместимую с исходным CSV-форматом;
* могут быть повторно открыты и обработаны программой.

### Особенности реализации

* Для обработки данных применяются:

  * массивы;
  * циклы;
  * условные операторы.
* Логика дополнительного задания вынесена в отдельные классы, каждый из которых отвечает за одну конкретную задачу, в соответствии с принципом единственной ответственности (SRP).

### Примечание

Дополнительная часть проекта не изменяет и не перезаписывает входной CSV-файл с исходными данными, а использует его только для чтения и формирования производных результатов.
